<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NSW Land Registry DApp</title>
    <!-- Web3.js -->
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">NSW Land Registry</a>
            <div class="d-flex">
                <button id="applyForRole" class="btn btn-light me-2" data-bs-toggle="modal" data-bs-target="#roleApplicationModal">Apply for Agent Role</button>
                <button id="connectWallet" class="btn btn-light">Connect Wallet</button>
                <span id="walletAddress" class="text-light ms-3"></span>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- 角色信息 -->
        <div class="alert alert-info" id="roleInfo">
            Please connect your wallet to view your role
        </div>

        <!-- 用户功能区 -->
        <div id="userSection" class="d-none">
            <h3>My Properties</h3>
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Property List</h5>
                    <div id="propertyList"></div>
                </div>
            </div>

            <h3>Agent Management</h3>
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Authorize Agent</h5>
                    <form id="authorizeAgentForm">
                        <div class="mb-3">
                            <label class="form-label">Agent Address</label>
                            <input type="text" class="form-control" id="agentAddress">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Property Folio Number</label>
                            <input type="text" class="form-control" id="authorizeFolio">
                        </div>
                        <button type="submit" class="btn btn-primary">Authorize</button>
                    </form>
                </div>
            </div>

            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Authorized Agents</h5>
                    <div id="agentList"></div>
                    <button class="btn btn-danger" id="revokeAgent">Revoke Authorization</button>
                </div>
            </div>
        </div>

        <!-- 代理人功能区 -->
        <div id="agentSection" class="d-none">
            <h3>Agent Functions</h3>
            
            <!-- 房产登记 -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Register Property</h5>
                    <form id="registerPropertyForm">
                        <div class="mb-3">
                            <label class="form-label">Folio Number</label>
                            <input type="text" class="form-control" id="registerFolio">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Owner Address</label>
                            <input type="text" class="form-control" id="ownerAddress">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Property Document</label>
                            <input type="file" class="form-control" id="propertyFile">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Expiry Time</label>
                            <input type="datetime-local" class="form-control" id="expiryTime">
                        </div>
                        <button type="submit" class="btn btn-primary">Register</button>
                    </form>
                </div>
            </div>

            <!-- 续期申请 -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Request Renewal</h5>
                    <form id="renewalForm">
                        <div class="mb-3">
                            <label class="form-label">Folio Number</label>
                            <input type="text" class="form-control" id="renewalFolio">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">New Expiry Time</label>
                            <input type="datetime-local" class="form-control" id="newExpiryTime">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Reason</label>
                            <textarea class="form-control" id="renewalReason"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit Request</button>
                    </form>
                </div>
            </div>

            <!-- 转移申请 -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Request Transfer</h5>
                    <form id="transferForm">
                        <div class="mb-3">
                            <label class="form-label">Folio Number</label>
                            <input type="text" class="form-control" id="transferFolio">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">New Owner Address</label>
                            <input type="text" class="form-control" id="newOwnerAddress">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Reason</label>
                            <textarea class="form-control" id="transferReason"></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Transfer Documents</label>
                            <input type="file" class="form-control" id="transferFile">
                        </div>
                        <button type="submit" class="btn btn-primary">Submit Request</button>
                    </form>
                </div>
            </div>

            <!-- 操作历史 -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Operation History</h5>
                    <div id="agentHistory"></div>
                </div>
            </div>
        </div>

        <!-- 管理员功能区 -->
        <div id="adminSection" class="d-none">
            <h3>Admin Functions</h3>
            
            <!-- 角色管理 -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Role Management</h5>
                    <form id="roleManagementForm">
                        <div class="mb-3">
                            <label class="form-label">Wallet Address</label>
                            <input type="text" class="form-control" id="roleAddress" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Role Type</label>
                            <select class="form-select" id="roleType" required>
                                <option value="">Select Role</option>
                                <option value="agent">Agent</option>
                                <option value="admin">Admin</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Action</label>
                            <select class="form-select" id="roleAction" required>
                                <option value="grant">Grant Role</option>
                                <option value="revoke">Revoke Role</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Execute</button>
                    </form>
                </div>
            </div>

            <!-- 角色申请列表 -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Role Applications</h5>
                    <div id="roleApplications"></div>
                </div>
            </div>

            <!-- 现有角色列表 -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Current Roles</h5>
                    <div id="existingRoles"></div>
                </div>
            </div>

            <!-- 待处理请求 -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Pending Requests</h5>
                    <ul class="nav nav-tabs" id="requestTabs">
                        <li class="nav-item">
                            <a class="nav-link active" data-bs-toggle="tab" href="#renewalRequests">Renewal Requests</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#transferRequests">Transfer Requests</a>
                        </li>
                    </ul>
                    <div class="tab-content mt-3">
                        <div class="tab-pane fade show active" id="renewalRequests">
                            <div id="pendingRenewals"></div>
                        </div>
                        <div class="tab-pane fade" id="transferRequests">
                            <div id="pendingTransfers"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 房产状态管理 -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Property Status Management</h5>
                    <form id="propertyStatusForm">
                        <div class="mb-3">
                            <label class="form-label">Folio Number</label>
                            <input type="text" class="form-control" id="statusFolio">
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="propertyActive">
                                <label class="form-check-label">Active Status</label>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Update Status</button>
                    </form>
                </div>
            </div>

            <!-- 系统状态查询 -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">System Status</h5>
                    <div id="systemStatus"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 角色申请模态框 -->
    <div class="modal fade" id="roleApplicationModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Apply for Agent Role</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="roleApplicationForm">
                        <div class="mb-3">
                            <label class="form-label">Application Reason</label>
                            <textarea class="form-control" id="applicationReason" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Supporting Documents</label>
                            <input type="file" class="form-control" id="applicationDocument" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="submitApplication">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html> 